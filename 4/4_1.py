# С помощью построения графика периодограммы изучить спектральный состав ряда
# “X2000Hz.txt” (Частота дискретизация сигнала 2000 Гц).
# Проредить ряд, перевыбрав его до частоты 200 Гц (т.е. создать новый ряд, выбрав из
# исходного каждый 10 отсчет). Изучить периодограмму прореженного сигнала с
# частотой 200 Гц и сопоставить ее с периодограммой исходного сигнала. Объяснить
# наблюдающиеся эффекты.
import numpy as np
import matplotlib.pyplot as plt

# загрузка данных
data = np.loadtxt('X2000Hz.txt')

# частота дискретизации
fs = 2000  # Гц

# построение периодограммы исходного сигнала
plt.figure(figsize=(12, 6))
plt.psd(data, NFFT=1024, Fs=fs, color='blue')
plt.title('Периодограмма исходного сигнала (2000 Гц)')
plt.xlabel('Частота (Гц)')
plt.ylabel('Плотность спектра мощности')
plt.grid()
plt.show()

# прореживание сигнала
downsampled_data = data[::10]
fs_new = fs / 10  # Новая частота дискретизации

# построение периодограммы прореженного сигнала
plt.figure(figsize=(12, 6))
plt.psd(downsampled_data, NFFT=1024, Fs=fs_new, color='red')
plt.title('Периодограмма прореженного сигнала (200 Гц)')
plt.xlabel('Частота (Гц)')
plt.ylabel('Плотность спектра мощности')
plt.grid()
plt.show()
